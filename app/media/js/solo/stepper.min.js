if(typeof Solo=="undefined"){var Solo={}}if(typeof Solo.Alice=="undefined"){Solo.Alice={URLs:{},tag:"",translations:{},akeebaUrl:"index.php?"}}var AkeebaStepper=function(c){this.options={holder:"#stepper-holder",loading:"#stepper-loading",pane:"#stepper-progress-pane",content:"#stepper-progress-content",steps:"#stepper-steps",status:"#stepper-status",step:"#stepper-step",substep:"#stepper-substep",percentage:"#stepper-percentage",timer:"#response-timer",useIframe:false,domainUrl:"&task=domains",pollingUrl:"&task=ajax",onBeforeStart:function(g){},onBeforeStep:function(h,g){},onComplete:function(g){}};this.options=akeeba.jQuery.extend(this.options,c||{});var e=this;var d={cache:false,data:{},dataType:"text",success:function(i){var h=new RegExp("###(.*?)###").exec(i);var g=JSON.parse(h[1]);e.renderBars(g.Domain);akeeba.jQuery(e.options.percentage+" div.bar").css({width:g.Progress+"%"});Piecon.setProgress(g.Progress);akeeba.jQuery(e.options.step).html(g.Step);akeeba.jQuery(e.options.substep).html(g.Substep);if(g.HasRun==1){e.complete(g)}else{setTimeout(function(){e.step(g)},10)}}};var b=function(){akeeba.jQuery.ajax(Solo.Alice.akeebaUrl+e.options.domainUrl,{cache:false,dataType:"text",beforeSend:function(){akeeba.jQuery(e.options.loading).show()},success:function(h){var g=new RegExp("###(.*?)###").exec(h);e.domains=JSON.parse(g[1]);akeeba.jQuery(e.options.loading).hide();akeeba.jQuery(e.options.pane).show("fast");e.continueAfterLoad()}})};var f=function(){var g=0;Piecon.setOptions({color:"#333333",background:"#e0e0e0",shadow:"#000000",fallback:"force"});akeeba.jQuery(e.options.timer+" div.text").everyTime(1000,"lastReponse",function(){g++;var h=Solo.Alice.translations["UI-LASTRESPONSE"].replace("%s",g.toFixed(0));akeeba.jQuery(e.options.timer+" div.text").html(h)})};var a=function(){akeeba.jQuery(e.options.timer+" div.text").stopTime().html(Solo.Alice.translations["UI-LASTRESPONSE"].replace("%s","0"))};this.init=function(){b()};this.continueAfterLoad=function(){this.renderBars();f();this.start()};this.renderBars=function(i){if(i==undefined){i=""}var g="label-success";var h="";if(i==""){g="label-default"}akeeba.jQuery(this.options.steps).html("");akeeba.jQuery.each(this.domains,function(j,k){var l=akeeba.jQuery(document.createElement("div")).addClass("label").html(k[1]).data("domain",k[0]).appendTo(e.options.steps);if(k[0]==i){g="label-default";h="label-info"}else{h=g}l.addClass(h)})};this.start=function(){this.options.onBeforeStart(d);d.data.ajax="start";akeeba.jQuery.ajax(Solo.Alice.akeebaUrl+this.options.pollingUrl,d)};this.step=function(g){this.options.onBeforeStep(d,g);a();f();d.data.ajax="step";akeeba.jQuery.ajax(Solo.Alice.akeebaUrl+this.options.pollingUrl,d)};this.complete=function(g){a();try{Piecon.reset()}catch(h){}this.options.onComplete(g)}};
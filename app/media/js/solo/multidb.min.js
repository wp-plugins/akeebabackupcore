if(typeof Solo=="undefined"){var Solo={}}if(typeof Solo.Multidb=="undefined"){Solo.Multidb={translations:{},loadingGif:""}}(function(a){Solo.Multidb.render=function(c){var b=a("#ak_list_contents");b.html("");a.each(c,function(d,e){Solo.Multidb.addRow(d,e,b)});Solo.Multidb.addNewRecordButton(b)};Solo.Multidb.addRow=function(b,d,c){a(document.createElement("tr")).addClass("ak_filter_row").data("root",b).data("def",d).append(a(document.createElement("td")).css("width","2em").append(a(document.createElement("span")).addClass("ak_filter_tab_icon_container label label-default").click(function(){var e={root:a(this).parent().parent().data("root"),verb:"remove"};Solo.Fsfilters.toggle(e,a(this).find("span").first(),function(f,g){if(f.success==true){g.parent().parent().parent().remove()}})}).append(a(document.createElement("span")).addClass("ak-toggle-button fa fa-trash-o deletebutton")))).append(a(document.createElement("td")).css("width","2em").append(a(document.createElement("span")).addClass("ak_filter_tab_icon_container label label-default").click(function(){var g=a(this).parent().parent();var f=a(this).parent().parent().data("def");var i=a(this).parent().parent().data("root");var h=a("#akEditorDialog");if(f.driver==""){f.driver="mysqli"}a("#ake_driver").val(f.driver);a("#ake_host").val(f.host);a("#ake_username").val(f.username);a("#ake_password").val(f.password);a("#ake_database").val(f.database);a("#ake_prefix").val(f.prefix);try{a("#ak_editor_notifier").remove()}catch(j){}a("#akEditorBtnDefault").click(function(){try{a("#ak_editor_notifier").remove()}catch(m){}a("#ak_editor_table").before(a(document.createElement("div")).addClass("alert alert-info alert-dismissable").attr("id","ak_editor_notifier").append(a(document.createElement("button")).attr({type:"button","class":"close","data-dismiss":"alert","aria-hidden":"true"}).html("&times;")).append(a(document.createElement("span")).attr("id","ak_editor_notifier_content").append(a(document.createElement("img")).attr({border:0,src:Solo.Multidb.loadingGif})).append(a(document.createElement("span")).html(Solo.Multidb.translations["UI-MULTIDB-LOADING"]))));var k={verb:"test",root:b,data:{host:a("#ake_host").val(),driver:a("#ake_driver").val(),port:a("#ake_port").val(),user:a("#ake_username").val(),password:a("#ake_password").val(),database:a("#ake_database").val(),prefix:a("#ake_prefix").val()}};var l={akaction:JSON.stringify(k)};Solo.System.doAjax(l,function(e){if(e.status==true){a("#ak_editor_notifier_content").html(Solo.Multidb.translations["UI-MULTIDB-CONNECTOK"])}else{a("#ak_editor_notifier_content").html(Solo.Multidb.translations["UI-MULTIDB-CONNECTFAIL"]+"<br/><code>"+e.message+"</code>")}},function(e){a("#ak_editor_notifier_content").html(Solo.Multidb.translations["UI-MULTIDB-CONNECTFAIL"]);a("#akEditorDialog").modal("hide");Solo.System.params.errorCallback(e)},false,15000)});a("#akEditorBtnSave").click(function(){try{a("#ak_editor_notifier").remove()}catch(m){}a("#ak_editor_table").before(a(document.createElement("div")).addClass("alert alert-info alert-dismissable").attr("id","ak_editor_notifier").append(a(document.createElement("button")).attr({type:"button","class":"close","data-dismiss":"alert","aria-hidden":"true"}).html("&times;")).append(a(document.createElement("span")).attr("id","ak_editor_notifier_content").append(a(document.createElement("img")).attr({border:0,src:Solo.Multidb.loadingGif})).append(a(document.createElement("span")).html(Solo.System.translations["UI-MULTIDB-LOADING"]))));var k={verb:"set",root:b,data:{host:a("#ake_host").val(),driver:a("#ake_driver").val(),port:a("#ake_port").val(),username:a("#ake_username").val(),password:a("#ake_password").val(),database:a("#ake_database").val(),prefix:a("#ake_prefix").val(),dumpFile:String(b).substr(0,9)+a("#ake_database").val()+".sql"}};var l={akaction:JSON.stringify(k)};Solo.System.doAjax(l,function(e){if(e==true){g.data("def",k.data);var n=g.children("td");n.find("span.ak_dbhost").html(k.data.host);n.find("span.ak_dbname").html(k.data.database);if(!n.find("span.editbutton").hasClass("fa-pencil-square")){n.find("span.deletebutton").parent().show();n.find("span.editbutton").removeClass("fa-plus-square").addClass("fa-pencil-square").addClass("ak-toggle-button");Solo.Multidb.addNewRecordButton(g.parent())}a("#akEditorDialog").modal("hide")}else{a("#ak_editor_notifier_content").html(Solo.Multidb.translations["UI-MULTIDB-SAVEFAIL"])}},function(e){a("#ak_editor_notifier_content").html(Solo.Multidb.translations["UI-MULTIDB-SAVEFAIL"]);a("#akEditorDialog").modal("hide");Solo.System.params.errorCallback(e)},false,15000)});h.modal({keyboard:false,backdrop:"static"});h.find("span").focus()}).append(a(document.createElement("span")).addClass("fa fa-pencil-square editbutton").addClass("ak-toggle-button")))).append(a(document.createElement("td")).addClass("ak_filter_item").append(a(document.createElement("span")).addClass("ak_filter_name").addClass("ak_dbhost").html(d.host))).append(a(document.createElement("td")).addClass("ak_filter_item").append(a(document.createElement("span")).addClass("ak_filter_name").addClass("ak_dbname").html(d.database))).appendTo(a(c))};Solo.Multidb.addNewRecordButton=function(d){var b=Math.uuid();var c={host:"",port:"",username:"",password:"",database:"",prefix:""};Solo.Multidb.addRow(b,c,d);a("#ak_list_contents tr:last-child td:first-child span:first").hide();a("#ak_list_contents tr:last-child td:nth-child(2) span:last").removeClass("fa-pencil-square").addClass("fa-plus-square").addClass("ak-toggle-button")}}(akeeba.jQuery));
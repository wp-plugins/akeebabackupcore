if(typeof Solo=="undefined"){var Solo={}}if(typeof Solo.Wizard=="undefined"){Solo.Wizard={URLs:{},execTimes:[30,25,20,14,7,5,3],blockSizes:[240,200,160,80,40,16,4,2,1],translation:{}}}(function(a){Solo.Wizard.boot=function(){Solo.Wizard.execTimes=[30,25,20,14,7,5,3];Solo.Wizard.blockSizes=[240,200,160,80,40,16,4,2,1];a("#backup-progress-pane").css("display","block");Solo.Backup.resetTimeoutBar();Solo.Wizard.tryAjax()};Solo.Wizard.tryAjax=function(){Solo.System.useIFrame=false;Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar(10000,100);a("#step-ajax").addClass("step-active");a("#backup-substep").text(Solo.Wizard.translation["UI-TRYAJAX"]);Solo.System.doAjax({act:"ping"},function(){Solo.System.useIFrame=false;a("#step-ajax").removeClass("label-info");a("#step-ajax").addClass("label-success");Solo.Wizard.minExec()},function(){Solo.System.useIFrame=true;Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar(10000,100);a("#backup-substep").text(Solo.Wizard.translation["UI-TRYIFRAME"]);Solo.System.doAjax({act:"ping"},function(){a("#step-ajax").removeClass("label-info");a("#step-ajax").addClass("label-success");Solo.Wizard.minExec()},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTUSEAJAX"])},false,10000)},false,10000)};Solo.Wizard.minExec=function(c,b){if(c==null){c=0}if(b==null){b=0}Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar((2*c+5)*1000,100);var d=Solo.Wizard.translation["UI-MINEXECTRY"].replace("%s",c.toFixed(1));a("#backup-substep").text(d);a("#step-minexec").addClass("label-info");Solo.System.doAjax({act:"minexec",seconds:c},function(e){b++;if(b<3){Solo.Wizard.minExec(c,b)}else{Solo.Wizard.minExecApply(c)}},function(){c+=0.5;if(c>20){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTDETERMINEMINEXEC"])}else{Solo.Wizard.minExec(c,0)}},false,(2*c+5)*1000)};Solo.Wizard.minExecApply=function(c){Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar(25000,100);a("#backup-substep").text(Solo.Wizard.translation["UI-SAVEMINEXEC"]);var b=0;if(Solo.Backup.useIFrame){b=1}Solo.System.doAjax({act:"applyminexec",iframes:b,minexec:c},function(d){a("#step-minexec").removeClass("label-info");a("#step-minexec").addClass("label-success");Solo.Wizard.directories()},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTSAVEMINEXEC"])},false)};Solo.Wizard.directories=function(){Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar(10000,100);a("#backup-substep").text("");a("#step-directory").addClass("label-info");Solo.System.doAjax({act:"directories"},function(b){if(b){a("#step-directory").removeClass("label-info");a("#step-directory").addClass("label-success");Solo.Wizard.database()}else{a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTFIXDIRECTORIES"])}},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTFIXDIRECTORIES"])},false)};Solo.Wizard.database=function(){Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar(30000,50);a("#backup-substep").text("");a("#step-dbopt").addClass("label-info");Solo.System.doAjax({act:"database"},function(b){if(b){a("#step-dbopt").removeClass("label-info");a("#step-dbopt").addClass("label-success");Solo.Wizard.maxExec()}else{a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTDBOPT"])}},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTDBOPT"])},false)};Solo.Wizard.maxExec=function(){var b=array_shift(Solo.Wizard.execTimes);if(empty(Solo.Wizard.execTimes)||(b==null)){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-EXECTOOLOW"]);return}Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar((b*1.2)*1000,80);a("#step-maxexec").addClass("label-info");var c=Solo.Wizard.translation["UI-MAXEXECTRY"].replace("%s",b.toFixed(0));a("#backup-substep").text(c);Solo.System.doAjax({act:"maxexec",seconds:b},function(d){if(d){Solo.Wizard.maxExecApply(b)}else{Solo.Wizard.maxExec()}},function(){Solo.Wizard.maxExec()},false,38000)};Solo.Wizard.maxExecApply=function(b){Solo.Backup.resetTimeoutBar();Solo.Backup.startTimeoutBar(10000,100);a("#backup-substep").text(Solo.Wizard.translation["UI-SAVINGMAXEXEC"]);Solo.System.doAjax({act:"applymaxexec",seconds:b},function(){a("#step-maxexec").removeClass("label-info");a("#step-maxexec").addClass("label-success");Solo.Wizard.partSize()},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTSAVEMAXEXEC"])})};Solo.Wizard.partSize=function(){Solo.Backup.resetTimeoutBar();var b=array_shift(Solo.Wizard.blockSizes);if(empty(Solo.Wizard.blockSizes)||(b==null)){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Solo.Wizard.translation["UI-CANTDETERMINEPARTSIZE"]);return}var d=b/8;Solo.Backup.startTimeoutBar(30000,100);var c=Solo.Wizard.translation["UI-PARTSIZE"].replace("%s",d.toFixed(3));a("#backup-substep").text(c);a("#step-splitsize").addClass("label-info");Solo.System.doAjax({act:"partsize",blocks:b},function(e){if(e){a("#step-splitsize").removeClass("label-info");a("#step-splitsize").addClass("label-success");Solo.Wizard.done()}else{Solo.Wizard.partSize()}},function(e){Solo.Wizard.partSize()},false,60000)};Solo.Wizard.done=function(){a("#backup-progress-pane").hide();a("#backup-complete").show()};Solo.Wizard.autodetect=function(b){var c={act:"pythia",folder:b};a(document.getElementById("varakeeba.advanced.embedded_installer]")).val("angie-generic");Solo.System.doAjax(c,function(e){var d=e.database.driver[0].toUpperCase()+e.database.driver.slice(1);a(document.getElementById("varakeeba.platform.scripttype")).val(e.cms);a(document.getElementsByName("var[akeeba.advanced.embedded_installer]")).val(e.installer);a(document.getElementById("var[akeeba.platform.dbdriver]")).val(d);a(document.getElementById("var[akeeba.platform.dbhost]")).val(e.database.host);a(document.getElementById("var[akeeba.platform.dbport]")).val(e.database.port);a(document.getElementById("var[akeeba.platform.dbusername]")).val(e.database.username);a(document.getElementById("var[akeeba.platform.dbpassword]")).val(e.database.password);a(document.getElementById("var[akeeba.platform.dbname]")).val(e.database.name);a(document.getElementById("var[akeeba.platform.dbprefix]")).val(e.database.prefix)});return false}}(akeeba.jQuery));